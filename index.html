<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Dr-Inovates</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <header>
        <img src="pic1.jpeg" alt="Dr-Inovates Logo" style="width: 100%; height: auto;">
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="voice-recording">
            <h2>Voice Recording (Real-Time)</h2>
            <button id="startStream">Start Real-Time Transcription</button>
            <button id="stopStream" disabled>Stop</button>
            <br><br>
            <textarea id="transcriptBox" rows="10" cols="80" readonly placeholder="Real-time transcript will appear here..."></textarea>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Dr-Inovates. All rights reserved.</p>
    </footer>

    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.947.0.min.js"></script>
    <!-- Amazon Transcribe WebSocket Client -->
    <script src="https://cdn.jsdelivr.net/npm/amazon-transcribe-websocket@1.0.5/dist/amazon-transcribe.min.js"></script>

    <script>
        AWS.config.region = 'ap-southeast-2';
        AWS.config.credentials = new AWS.CognitoIdentityCredentials({
            IdentityPoolId: 'ap-southeast-2:e1961e14-083d-4200-bb2b-c869a5ffbc3d'
        });

        const startButton = document.getElementById('startStream');
        const stopButton = document.getElementById('stopStream');
        const transcriptBox = document.getElementById('transcriptBox');

        let transcriber;

        startButton.addEventListener('click', async () => {
            transcriptBox.value = "";
            startButton.disabled = true;
            stopButton.disabled = false;

            transcriber = new AmazonTranscribe({
                region: 'ap-southeast-2',
                credentials: AWS.config.credentials,
                languageCode: 'en-US',
                sampleRate: 44100,
                streamAudioFromBrowser: true,
                transcriptionEventHandler: event => {
                    const results = event.Transcript.Results;
                    if (results.length > 0 && results[0].Alternatives.length > 0) {
                        const transcript = results[0].Alternatives[0].Transcript;
                        if (!results[0].IsPartial) {
                            transcriptBox.value += transcript + '\n';
                        }
                    }
                },
                errorHandler: err => {
                    console.error('Transcribe error:', err);
                    alert('Real-time transcription failed. Check console.');
                },
                onConnectionClose: () => {
                    console.log("Transcribe connection closed.");
                }
            });

            await transcriber.start();
        });

        stopButton.addEventListener('click', async () => {
            stopButton.disabled = true;
            startButton.disabled = false;
            if (transcriber) await transcriber.stop();
        });
    </script>
</body>
</html>
